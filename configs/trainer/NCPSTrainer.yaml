defaults:
  - _self_

method: n-cps

train:
  total_epochs: 200
  validation_interval: 10

init:
  _target_: trainer.NCPSTrainer

  num_models: 3        # balanced diversity

  supervised_criterion:
    _target_: torch.nn.MSELoss

  unsupervised_criterion:
    _target_: torch.nn.MSELoss

  optimizer:
    _target_: torch.optim.AdamW
    _partial_: true
    lr: 0.0007          # slightly lower works better with 3-model CPS
    weight_decay: 0.005

  scheduler:
    _target_: torch.optim.lr_scheduler.CosineAnnealingLR
    _partial_: true
    T_max: 100

  # CPS hyperparameters tuned for stability on QM9 regression
  cps_weight: 0.0005
  cps_rampup_epochs: 150

  # Only trust low-uncertainty pseudo-labels from the ensemble
  confidence_threshold: 0.1

  # Strong augmentations for CPS (match Mean Teacher defaults)
  strong_augment_node_noise_std: 0.05
  strong_augment_edge_drop_prob: 0.05
