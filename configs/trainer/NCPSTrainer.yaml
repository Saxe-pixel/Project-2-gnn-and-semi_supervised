defaults:
  - _self_

method: n-cps

train:
  total_epochs: 100
  validation_interval: 10

init:
  _target_: trainer.NCPSTrainer

  num_models: 3

  supervised_criterion:
    _target_: torch.nn.MSELoss

  unsupervised_criterion:
    _target_: torch.nn.MSELoss

  optimizer:
    _target_: torch.optim.AdamW
    _partial_: true
    lr: 0.0007
    weight_decay: 0.005

  scheduler:
    _target_: torch.optim.lr_scheduler.CosineAnnealingLR
    _partial_: true
    T_max: 100

  # Strong CPS + slow warm-up + soft weighting
  cps_weight: 2.0
  cps_rampup_epochs: 80
  mask_percentile: 0.05

  # Very soft augmentations for regression
  strong_node_noise: 0.003
  strong_edge_drop: 0.002
